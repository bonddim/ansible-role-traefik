---
### Static configuration
entryPoints:
  web:
    address: :80
    http:
      redirections:
        entryPoint:
          to: websecure
          scheme: https
  websecure:
    address: :443
    http:
      tls:
        certResolver: letsEncrypt
        domains:
          - main: {{ main_domainname }}

# Enable ACME (Let's Encrypt): automatic SSL
certificatesResolvers:
  letsEncrypt:
    acme:
      email: {{ email_address }}
      storage: {{ traefik_acme_storage_file }}
      {% if traefik_acme_staging | default(false) -%}
      caServer: https://acme-staging-v02.api.letsencrypt.org/directory
      {% endif -%}
      httpChallenge:
        entryPoint: web

# Active config providers
providers:
  # Docker configuration backend
  docker:
    exposedByDefault: false
    defaultRule: PathPrefix(`/{{ '{{ normalize .Name }}' }}`)

  # File configuration backend
  file:
    filename: {{ traefik_configfile_dynamic }}
    watch: true

# API and dashboard configuration
api:
  insecure: false
  dashboard: {{ traefik_dashboard | default(true) }}

# Logs configuration
log:
  level: {{ traefik_log_level | default('ERROR') }}
  format: {{ traefik_log_format | default('json') }}
